<div class="container">
  <div class="form-container">
    <div class="icon-container" style="margin-bottom: 2em">
      <img src="assets/icon/sy_final.svg" height="45%" />
    </div>
    @if(currStep==1){
    <h1>Sign Up</h1>
    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <div class="form-row">
        <div class="form-group">
          <label for="firstName">First Name</label>
          <input
            type="text"
            id="firstName"
            name="firstName"
            placeholder="Jim"
            formControlName="fName"
          />
          @if(form.get('fName')?.invalid && (form.get('fName')?.touched ||
          form.get('fName')?.dirty)) { @if(form.get('fName')?.invalid) {
          <div class="error-msg">*Required</div>
          } }
        </div>

        <div class="form-group">
          <label for="lastName">Last Name</label>
          <input
            type="text"
            id="lastName"
            name="lastName"
            placeholder="Jones"
            formControlName="lName"
          />
          @if(form.get('lName')?.invalid && (form.get('lName')?.touched ||
          form.get('lName')?.dirty)) { @if(form.get('lName')?.invalid) {
          <div class="error-msg">*Required</div>
          } }
        </div>
      </div>

      <div class="form-group">
        <label for="email">Email Address</label>
        <input
          type="email"
          id="email"
          name="email"
          formControlName="email"
          placeholder="jim_jones221@symail.co"
        />
        @if(form.get('email')?.errors?.['pattern'] &&
        form.get('email')?.touched){ @if(form.get('email')?.errors?.['pattern']
        && form.get('email')?.touched){
        <div class="error-msg">
          *Email can use letters, numbers, dots (.), underscores (_), percent
          (%), plus (+), hyphens (-) and must end with
          <strong> @symail.co </strong>
        </div>
        } }@else if(form.get('email')?.touched && form.get('email')?.invalid){
        <div class="error-msg">*Email is required</div>

        }
      </div>

      <div class="form-group">
        <label for="dateOfBirth">Date of Birth</label>
        <input
          type="date"
          id="dateOfBirth"
          name="dateOfBirth"
          formControlName="dob"
        />
        @if (form.get('dob')?.invalid && form.get('dob')?.touched) {
        <div class="error-msg">*Enter a valid date of birth</div>
        }
      </div>

      <div class="form-group">
        <label for="password">Password</label>
        <input
          type="password"
          id="password"
          name="password"
          formControlName="pass"
        />
        @if (form.get('pass')?.invalid && form.get('pass')?.touched) {
        <div class="error-msg">*Password is required</div>
        }
      </div>
      <div class="form-group">
        <label for="password">Re-Enter Password</label>
        <input
          type="password"
          id="rpassword"
          name="rpassword"
          formControlName="rpass"
        />
        @if(form.errors?.['notMatched']){
        <div class="error-msg" id="pMatchingError">*Passwords Do Not Match</div>
        }
      </div>

      @if(form.get('pass')?.errors?.['pattern'] && form.get('pass')?.touched){
      <div class="p-guidelines" id="pConstraints">
        Password must contain at least:
        <ul>
          <li>1 lowercase</li>
          <li>1 uppercase</li>
          <li>1 number</li>
          <li>1 special character</li>
          <li>Minimum length 9</li>
        </ul>
      </div>
      }

      <button type="submit" class="submit-btn">Create Account</button>
    </form>
    }@else if(currStep==2){
    <h1>Additional Information</h1>

    <form [formGroup]="form2" (ngSubmit)="onSubmit2()">
      <label
        for="pNum"
        style="font-weight: 500; color: #374151; white-space: nowrap"
        >Phone Number</label
      >
      <div class="inputBar">
        <div class="phoneParent" #dropdown>
          <div
            class="search-container country-list"
            [class.active]="isDropdownOpen"
          >
            @if(isDropdownOpen){
            <input
              type="text"
              class="search-input"
              placeholder="Search countries..."
              [formControl]="searchControl"
            />

            @for (country of filteredCountries$ | async; track country.code) {
            <button
              type="button"
              class="country-option"
              (click)="selectCountry(country)"
            >
              <span class="flag">{{ country.flag }}</span>
              <div class="country-info">
                <div class="country-name">{{ country.name }}</div>
                <div class="country-dial-code">{{ country.dialCode }}</div>
              </div>
            </button>
            } }
          </div>
          <button
            type="button"
            class="country-button"
            [class.active]="isDropdownOpen"
            (click)="toggleDropdown()"
          >
            <span class="flag">{{ selectedCountry?.flag }}</span>
            <span class="dial-code">{{ selectedCountry?.dialCode }}</span>
            <svg
              class="chevron"
              [class.rotated]="isDropdownOpen"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="6,9 12,15 18,9"></polyline>
            </svg>
          </button>
        </div>

        <input
          type="tel"
          id="pNum"
          name="pNum"
          placeholder="9381913352"
          formControlName="pNo"
          class="pInput"
          maxlength="10"
          inputmode="numeric"
          pattern="[0-9]*"
          oninput="this.value = this.value.replace(/[^0-9]/g, '')"
        />
      </div>

      @if(form2.get('pNo')?.invalid && (form2.get('pNo')?.touched ||
      form2.get('pNo')?.dirty)) { @if(form2.get('pNo')?.invalid) {
      <div class="error-msg" style="margin: 0.1em">*Required</div>
      } }

      <div class="form-row" style="margin-top: 0.5em">
        <div class="form-group">
          <label for="country">Country</label>
          <div class="country-selector-container-1">
            <button
              type="button"
              class="country-selected-1"
              id="countrySelector"
              disabled
            >
              <span id="selectedCountryText">{{ selectedCountry?.name }}</span>
            </button>
          </div>
        </div>

        <div class="form-group">
          <label for="city">City</label>
          <input
            type="text"
            id="city"
            name="city"
            formControlName="city"
            placeholder="Hyderabad"
            oninput="this.value = this.value.replace(/[^a-zA-Z ]/g, '')"
          />
          @if(form2.get('city')?.invalid && (form2.get('city')?.touched ||
          form2.get('city')?.dirty)) { @if(form2.get('city')?.invalid) {
          <div class="error-msg">*Required</div>
          } }
        </div>
      </div>

      <div class="form-row-1">
        <div class="form-group address">
          <label for="address">Address</label>
          <input
            type="text"
            id="address"
            name="address"
            placeholder="Flat No. 203, Sunrise Apartments  
Road No. 10, Banjara Hills  
Hyderabad, Telangana, 
India "
            formControlName="address"
          />
          @if(form2.get('address')?.invalid && (form2.get('address')?.touched ||
          form2.get('address')?.dirty)) { @if(form2.get('address')?.invalid) {
          <div class="error-msg">*Required</div>
          } }
        </div>

        <div class="form-group pincode">
          <label for="pincode">Pin Code</label>
          <input
            type="phone"
            id="pincode"
            name="pincode"
            placeholder="500072"
            formControlName="pin"
            maxlength="10"
            inputmode="numeric"
            pattern="[0-9]*"
            oninput="this.value = this.value.replace(/[^a-zA-Z0-9 ]/g, '')"
          />
          @if(form2.get('pin')?.invalid && (form2.get('pin')?.touched ||
          form2.get('pin')?.dirty)) { @if(form2.get('pin')?.invalid) {
          <div class="error-msg">*Required</div>
          } }
        </div>
      </div>
      <div class="button-row">
        <button (click)="prevStep()" class="submit-btn">Back</button>
        <button type="submit" class="submit-btn">Submit</button>
      </div>
    </form>

    }@else if(currStep==3) {
    <div class="redirect-container">
      <div class="success-icon"></div>

      <h1 class="redirect-h">Account Created Successfully!</h1>

      <p class="message">Your account will be live shortly</p>

      <p class="redirect-message">
        Redirecting you to login page, if you haven't been redirected
        automatically, click on this link!
      </p>

      <a href="#" class="login-link">Go to Login Page</a>

      <div class="loading-dots">
        <span class="dot"></span>
        <span class="dot"></span>
        <span class="dot"></span>
      </div>
    </div>
    }
  </div>
</div>
